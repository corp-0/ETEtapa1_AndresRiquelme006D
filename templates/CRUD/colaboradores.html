{% extends 'CRUD/base.html' %}
{% block class_colabs %}active{% endblock %}
{% block enlace_agregar %}{% url 'agregar_colaborador' %}{% endblock %}
{% block header_tabla %}
    <tr>
        <th>Nombre usuario</th>
        <th>Nombre completo</th>
        <th>Rut</th>
        <th>Dirección</th>
        <th>Teléfono</th>
        <th>País</th>
    </tr>
{% endblock %}
{% block cuerpo_tabla %}
    {% for colab in colaboradores %}
        <tr>
            <td>{{ colab.user }}</td>
            <td>{{ colab.nombre }}</td>
            <td>{{ colab.rut }}</td>
            <td>{{ colab.direccion }}</td>
            <td>{{ colab.fono }}</td>
            <td>{{ colab.pais }}</td>
            <td>
                <a href="{% url 'editar_colab' colab.user %}" class="waves-effect waves-teal btn-flat">
                    <i class="material-icons">edit</i>
                </a>
            </td>
            <td>
                <a
                        class="waves-effect waves-teal btn-flat modal-trigger"
                        onclick="setModalData('{{ colab.user_id }}','{{ colab.nombre }}')"
                        href="#modal1"><i class="material-icons red-text">clear</i>
                </a>
            </td>
        </tr>
    {% endfor %}
    {% if colaboradores.has_other_pages %}
    {% include 'common/pagination_table.html' with paginator=colaboradores %}
    {% endif %}


    <div id="modal1" class="modal">
        <div class="modal-content">
            <h4>¿Está seguro?</h4>
            <p id="modalMensaje">weuweuweuweuweuw</p>
        </div>
        <div class="modal-footer">
            <a id="botonBorrar" href="{% url 'borrar_usuario' 'ID_COLAB' %}"
               class="modal-close waves-effect waves-red btn-flat">Eliminar</a>
            <a onclick="resetModalData()" class="modal-close waves-effect waves-green btn-flat">Volver</a>
        </div>
    </div>

{% endblock %}

{% block extra_js %}
<script>
    function setModalData(pk, nombre) {
        document.getElementById("modalMensaje").innerHTML = "Se eliminará <b>" + nombre + "</b>, ¡Permanentemente!";
        let url = document.getElementById("botonBorrar").getAttribute("href");
        url = url.replace("ID_COLAB", pk)
        document.getElementById("botonBorrar").setAttribute("href", url);
    }

    function resetModalData() {
        const btn = document.getElementById("botonBorrar");
        btn.setAttribute("href", "{% url 'borrar_usuario' 'ID_COLAB' %}")
    }

    document.addEventListener('DOMContentLoaded', function () {
        const elems = document.querySelectorAll('.modal');
        const instances = M.Modal.init(elems);
    });
</script>
{% endblock %}

